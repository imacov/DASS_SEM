<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Demonstration: A more in-depth consideration of model accuracy | SOST70073 Structural Equation Modelling</title>
  <meta name="description" content="Notebook hosting practical materials for SOST70033." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Demonstration: A more in-depth consideration of model accuracy | SOST70073 Structural Equation Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notebook hosting practical materials for SOST70033." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Demonstration: A more in-depth consideration of model accuracy | SOST70073 Structural Equation Modelling" />
  
  <meta name="twitter:description" content="Notebook hosting practical materials for SOST70033." />
  

<meta name="author" content="Dr. Nick Shryane" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="overview.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/logos/uom_logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="part"><span><b>Section 1</b></span></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="demonstration-a-more-in-depth-consideration-of-model-accuracy.html"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html"><i class="fa fa-check"></i>Demonstration: A more in-depth consideration of model accuracy</a>
<ul>
<li class="chapter" data-level="" data-path="demonstration-a-more-in-depth-consideration-of-model-accuracy.html"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#the-simulation"><i class="fa fa-check"></i>The Simulation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SOST70073 Structural Equation Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<hr>
<center> 
  <div class="header">
   <img src="images/banners/SEM_banner.png" alt="Trulli">
  </div>
</center>
<div id="demonstration-a-more-in-depth-consideration-of-model-accuracy" class="section level1 unnumbered hasAnchor">
<h1>Demonstration: A more in-depth consideration of model accuracy<a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#demonstration-a-more-in-depth-consideration-of-model-accuracy" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>This demonstration was developed by Dr. Tatjana Kecojevic, Lecturer in Social Statistics.</em></p>
<p>So we discussed earlier that statistical modeling allows us to explain and dig deeper into understanding the nature of a process of a phenomenon of interest and that we can mathematically describe this phenomenon as an unknown function <span class="math inline">\(f\)</span>. In its related data, we annotate the information that can explain the problem’s
behaviour as <span class="math inline">\(x\)</span> (this could be a single value or a vector or matrix of values
or something more complex) and the results of its behaviour as <span class="math inline">\(y\)</span> (this
could also be a single value or something more complex).</p>
<p>Mathematically we present this as:</p>
<p><span class="math display">\[y_i = f(x_i)\]</span><br />
And of course, let’s not forget about the variation of the <span class="math inline">\(f\)</span>’s behaviour:</p>
<p><span class="math display">\[y_i = f(x_i) + \epsilon_i\]</span></p>
<p>The standard approach for the error/noise is to adopt the following distribution structure <span class="math inline">\(\epsilon \sim N(0,\sigma)\)</span>, meaning that the <span class="math inline">\(\epsilon\)</span> value is
considered to be normally distributed with a mean of <span class="math inline">\(0\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>. Remember that this implies that the negative and positive impacts from the noise are considered equally likely, and that small errors are much more likely than extreme ones.</p>
<p>To evaluate the performance of a statistical model on a given data set, we “observe” the discrepancies between the predicted response values for given observations obtained by the chosen statistical model (<span class="math inline">\(\hat{f}(x_i)\)</span>) and the true response values for these observations (<span class="math inline">\(y_i\)</span>). As I already mentioned, the most commonly used performance measure for regression problems is the <strong>mean squared error</strong> (<strong>MSE</strong>):</p>
<p><span class="math display">\[MSE =  \frac{1}{n} \sum^{n}_{i=1}(y_i - \hat{f}(x_i))^2\]</span><br />
The <strong>MSE</strong> above is computed using the <em>training data</em>, used to fit the model, and as such it would be more correct to refer to it as the <strong>training</strong> <strong>MSE</strong>.</p>
<p>But we have already discussed that we are not really interested how well the model “works” on the training data, ie. <span class="math inline">\(\hat{f}(x_i) \approx y_i\)</span>. We are more interested in the accuracy of the predictions <span class="math inline">\(\hat{f}(x_0)\)</span> that are obtained when we apply the model to previously unseen test data <span class="math inline">\((x_0, y_0)\)</span>, ie. <span class="math inline">\(\hat{f}(x_0) \approx y_0\)</span>.</p>
<p>In other words, we want to chose the model with the lowest <span class="math inline">\(test\)</span> <span class="math inline">\(MSE\)</span> and to do so we need a large enough number of observations in the test data to calculate the <strong>mean square prediction error</strong> for the test observations (<span class="math inline">\(x_0\)</span>, <span class="math inline">\(y_0\)</span>), to which we can refer to as the <span class="math inline">\(test\)</span> <span class="math inline">\(MSE\)</span>.</p>
<p><span class="math display">\[mean(y_0 - \hat{f}(x_0))^2\]</span></p>
<p>In statistics nothing is black and white. In other words, nothing is straightforward and there are many considerations one needs to take into account when applying statistical modelling. The same applies in this situation. We need to realise that when a given model yields a small training MSE but a large test MSE, we are said to be <strong>overfitting</strong> the data. The statistical model is too ‘preoccupied’ to find patterns in the training data and consequently is modelling the patterns that are caused by random effects, rather than by true features of the unknown function <span class="math inline">\(f\)</span>. When the model overfits the training data, the test MSE will be large because the modelled features that the model identifies in the training data just <em>do not exist</em> in the test data. Saying that, regardless of overfitting occurring or not, we expect the training MSE to be smaller than the test MSE, as most of the statistical models either directly or indirectly seek to minimise the training MSE. We need to be aware that the chosen model needs to be flexible and not rigid and glued to the training data.</p>
<p>MSE is simple to calculate and yet, despite its simplicity, it can provide us with a vital insight into modelling. It consists of two intrinsic components that can provide greater enlightenment about how the model works:</p>
<ul>
<li><p>variance: degree to which <span class="math inline">\(\hat{f}\)</span> would differ if we estimated it using a different training dataset (ideally, it should <em>not</em> vary greatly).</p></li>
<li><p>bias: average difference between the estimator <span class="math inline">\(\hat{y}\)</span> and true value <span class="math inline">\(y\)</span>. Mathematically we write bias as:</p></li>
</ul>
<p><span class="math display">\[E[\hat{y} – y]\]</span></p>
<p>As it is not squared difference, it can be either positive or negative. Positive or negative bias implies that the model is over or under “predicting”, while the value of zero would indicate that the model is likely to predict too much as it is to predict too little. The latter implies that the model can be completely wrong in its prediction and still provide us with the bias of zero. This implies that bias on its own provides little information about how correct the model is in its
prediction.</p>
<p>Remember that <span class="math inline">\(y = f(x) + \epsilon\)</span> and therefore <span class="math inline">\(\hat{f}\)</span> is not directly approximating <span class="math inline">\(f\)</span>. <span class="math inline">\(\hat{f}\)</span> models <span class="math inline">\(y\)</span> that includes the noise. It can be challenging and in some cases even impossible to meaningfully capture the behaviour of <span class="math inline">\(f\)</span> itself when the noise term is very large. We have discussed earlier that we assess model accuracy using MSE which is calculated by:</p>
<ol style="list-style-type: decimal">
<li>obtaining the error (i.e. discrepancy between <span class="math inline">\(\hat{f}(x_i)\)</span> and
<span class="math inline">\(y_i\)</span>)</li>
<li>squaring this value (making negative into the positive same, and
greater error gets more severe penalty)</li>
<li>then averaging these results</li>
</ol>
<p>The mean of the squared error is the same as the expectation<span class="math inline">\(^*\)</span> of our squared error so we can go ahead and simplify this a slightly:</p>
<p><span class="math display">\[MSE=E[(y-\hat{f}(x))^2]\]</span></p>
<p>Now, we can break this further and write it as:</p>
<p><span class="math display">\[MSE = E[(f(x)+ \epsilon - \hat{f}(x))^2]\]</span><br />
Knowing that computing the expectation of adding two random variables is the same as computing the expectation of each random variable and then adding them up:</p>
<p><span class="math display">\[E[X+Y]=E[X] +E[Y]\]</span></p>
<p>and recalling that <span class="math inline">\(\sigma^2\)</span> represent the variance of <span class="math inline">\(\epsilon\)</span>, where the variance is calculated as:</p>
<p><span class="math display">\[E[X^2]-E[X]^2,\]</span></p>
<p>and therefore:<br />
<span class="math display">\[Var(\epsilon) = \sigma^2 = E[\epsilon^2] - E[\epsilon]^2,\]</span></p>
<p>with <span class="math inline">\(\epsilon \sim N(0,\sigma)\)</span></p>
<p><span class="math display">\[E[\epsilon]^2=\mu^2=0^2=0\]</span>
we get:</p>
<p><span class="math display">\[E[\epsilon^2] = \sigma^2\]</span></p>
<p>This helps us to rearranging MSE further and calculate it as:</p>
<p><span class="math display">\[MSE=σ^2+E[−2f(x)\hat{f}(x)+f(x)^2+\hat{f}(x)^2]\]</span></p>
<p>where <span class="math inline">\(\sigma^2\)</span> is the variance of the noise (i.e. <span class="math inline">\(\epsilon\)</span>). Therefore, the variance of the noise in data is an <strong><em>irreducible part</em></strong> of the MSE. Regardless of how good the model is, it can never reduce the MSE to being less than the variance related to the noise (i.e. <strong>error</strong>). This error represents the lack of information in data used to adequately explain everything that can be known about the phenomena being modelled. We should not look at it as a nuisance, as it can often guide us to further explore the problem and look into other factors that might be related to it.</p>
<p>Knowing that:
<span class="math display">\[Var(X) = E[X^2] - E[X]^2\]</span></p>
<p>we can apply further transformation and break MSE into:</p>
<p><span class="math display">\[MSE = \sigma^{2}+Var[f(x)-\hat{f}(x)]+E[f(x)-\hat{f}(x)]^2\]</span></p>
<p>The term <span class="math inline">\(Var[f(x)-\hat{f}(x)]\)</span> is the <em>variance</em> in the model predictions from
the true output values and the last term <span class="math inline">\(E[f(x)-\hat{f}(x)]^2\)</span> is just the <em>bias</em> squared. We mentioned earlier that that unlike variance, bias can be positive or negative, so we square this value in order to make sure it is always positive.</p>
<p>With this in mind, we realise that MSE consists of:</p>
<ol style="list-style-type: lower-roman">
<li>model variance</li>
<li>model bias and</li>
<li>irreducible error</li>
</ol>
<p><span class="math display">\[\text{Mean Squared Error}=\text{Model Variance} + \text{Model Bias}^2 + \text{Irreducible Error}\]</span></p>
<p>We come to the conclusion that in order to <strong><em>minimise</em></strong> the <strong>expected test error</strong>, we need to select a statistical model that simultaneously achieves low variance and low bias.</p>
<p>Note that in practice we will never know what the variance <span class="math inline">\(\sigma^2\)</span> of the error <span class="math inline">\(\epsilon\)</span> is, and therefore we will not be able to determine the variance and the bias of the model. However, since <span class="math inline">\(\sigma^2\)</span> is constant, we have to decrease either bias or variance to improve the model.</p>
<p>Testing the model using the test data and observing its bias and variance can help us address some important issues, allowing us to reason with the model. If the model fails to find the <span class="math inline">\(f\)</span> in data and is systematically over or under predicting, this will indicate <strong>underfitting</strong> and it will be reflected through high bias. However, high variance when working with test data indicates the issue of <strong>overfitting</strong>. What happens is that the model has learnt the training data really well and is too close to the data, so much so that it starts to mistake the <span class="math inline">\(f(x) + \epsilon\)</span> for true <span class="math inline">\(f(x)\)</span>.</p>
<div id="the-simulation" class="section level2 unnumbered hasAnchor">
<h2>The Simulation<a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#the-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To better understand these concepts, let us run a small simulation study. We
will:</p>
<ol style="list-style-type: lower-roman">
<li>simulate a function <span class="math inline">\(f\)</span></li>
<li>apply the error, i.e. noise sampled from a distribution with a known
variance</li>
</ol>
<p>To make it very simple and illustrative we will use a linear function <span class="math inline">\(f(x) = 3 + 2x\)</span> to simulate response <span class="math inline">\(y\)</span> with the error <span class="math inline">\(e\thicksim N(\mu =0, \sigma^2 =4)\)</span>, where <span class="math inline">\(x\)</span> is going to be a sequence of numbers between <span class="math inline">\(0\)</span> and <span class="math inline">\(10\)</span> in steps of <span class="math inline">\(0.1\)</span>. We will examine the simulations for the models that over and under estimate the true <span class="math inline">\(f\)</span>, and since it is a linear function we will not have a problem identifying using simple linear regression modelling.</p>
<p>Let’s start with a simulation in which we will model the true function with <span class="math inline">\(\hat{f}_{1} = 4 + 2x\)</span> and <span class="math inline">\(\hat{f}_{2} = 1 + 2x\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="do">## set the seed of R‘s random number generator</span></span>
<span id="cb1-2"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-3" tabindex="-1"></a><span class="co"># simulate function f(x) = 3 + 2x</span></span>
<span id="cb1-4"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-4" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1-5"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-5" tabindex="-1"></a>  <span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x </span>
<span id="cb1-6"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-6" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-7" tabindex="-1"></a><span class="co"># generate vector X</span></span>
<span id="cb1-8"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.05</span>)</span>
<span id="cb1-9"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-9" tabindex="-1"></a><span class="co"># the error term coming from N(mean = 0, variance = 4)</span></span>
<span id="cb1-10"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-10" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb1-11"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-11" tabindex="-1"></a><span class="co"># simulate the response vector Y</span></span>
<span id="cb1-12"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-12" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">f</span>(x) <span class="sc">+</span> e</span>
<span id="cb1-13"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-14" tabindex="-1"></a><span class="co"># plot the simulated data </span></span>
<span id="cb1-15"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-15" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">cex =</span> <span class="fl">0.75</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">main =</span> <span class="st">&quot;Simulation: 1&quot;</span>) </span>
<span id="cb1-16"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="at">col =</span><span class="st">&quot;gray&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb1-17"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-17" tabindex="-1"></a><span class="co"># model fitted to simulated data</span></span>
<span id="cb1-18"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-18" tabindex="-1"></a>f_hat_1<span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1-19"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-19" tabindex="-1"></a>  <span class="dv">4</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x</span>
<span id="cb1-20"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-20" tabindex="-1"></a>}</span>
<span id="cb1-21"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-21" tabindex="-1"></a>f_hat_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1-22"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-22" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x</span>
<span id="cb1-23"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-23" tabindex="-1"></a>}</span>
<span id="cb1-24"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-24" tabindex="-1"></a>y_bar <span class="ot">=</span> <span class="fu">mean</span>(y) <span class="co"># average value of the response variable y</span></span>
<span id="cb1-25"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-25" tabindex="-1"></a>f_hat_3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1-26"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-26" tabindex="-1"></a>  y_bar</span>
<span id="cb1-27"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-27" tabindex="-1"></a>}</span>
<span id="cb1-28"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-28" tabindex="-1"></a><span class="co"># add the line representing the fitted model</span></span>
<span id="cb1-29"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-29" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb1-30"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-30" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb1-31"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-31" tabindex="-1"></a><span class="fu">abline</span>(y_bar, <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb1-32"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-32" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">7.5</span>, <span class="dv">10</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;f_hat_1&quot;</span>, <span class="st">&quot;f_hat_2&quot;</span>, <span class="st">&quot;f_hat_3&quot;</span>, <span class="st">&quot;f&quot;</span>),</span>
<span id="cb1-33"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-33" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;gray&quot;</span>), </span>
<span id="cb1-34"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-34" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb1-35"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb1-35" tabindex="-1"></a>       <span class="at">text.font =</span> <span class="dv">4</span>, <span class="at">bg =</span> <span class="st">&#39;lightyellow&#39;</span>)</span></code></pre></div>
<p><img src="01-S01-D1_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Observing the graph, we notice that <span class="math inline">\(\hat{f}_1\)</span> and <span class="math inline">\(\hat{f}_2\)</span>, depicted in blue and red lines respectively, follow the data nicely, but are also systematically over (in the case of <span class="math inline">\(\hat{f}_1\)</span> and under (in the case of <span class="math inline">\(\hat{f}_2\)</span>) estimating the values. In the simple model <span class="math inline">\(\hat{f}_3\)</span>, the line represents the value <span class="math inline">\(\bar{y}\)</span>, which cuts the data in half.</p>
<p>As we mentioned earlier, knowing the true function <span class="math inline">\(f\)</span> and the distribution of <span class="math inline">\(\epsilon\)</span> we can calculate: - the MSE using the simulated data and the estimated model, - the model’s bias and variance which will allow for the calculation of the “theoretical” MSE. This will allow for more detailed illustration about the information contained in the model’s bias and variance.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-1" tabindex="-1"></a><span class="co"># calculate MSE from data</span></span>
<span id="cb2-2"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-2" tabindex="-1"></a>MSE_data1 <span class="ot">=</span> <span class="fu">mean</span>((y <span class="sc">-</span> <span class="fu">f_hat_1</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-3"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-3" tabindex="-1"></a>MSE_data2 <span class="ot">=</span> <span class="fu">mean</span>((y <span class="sc">-</span> <span class="fu">f_hat_2</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-4"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-4" tabindex="-1"></a>MSE_data3 <span class="ot">=</span> <span class="fu">mean</span>((y <span class="sc">-</span> <span class="fu">f_hat_3</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-5"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-5" tabindex="-1"></a><span class="co"># model bias </span></span>
<span id="cb2-6"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-6" tabindex="-1"></a>bias_1 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">f_hat_1</span>(x) <span class="sc">-</span> <span class="fu">f</span>(x))</span>
<span id="cb2-7"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-7" tabindex="-1"></a>bias_2 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">f_hat_2</span>(x) <span class="sc">-</span> <span class="fu">f</span>(x))</span>
<span id="cb2-8"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-8" tabindex="-1"></a>bias_3 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">f_hat_3</span>(x) <span class="sc">-</span> <span class="fu">f</span>(x))</span>
<span id="cb2-9"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-9" tabindex="-1"></a><span class="co"># model variance</span></span>
<span id="cb2-10"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-10" tabindex="-1"></a>var_1 <span class="ot">=</span> <span class="fu">var</span>(<span class="fu">f</span>(x) <span class="sc">-</span> <span class="fu">f_hat_1</span>(x))</span>
<span id="cb2-11"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-11" tabindex="-1"></a>var_2 <span class="ot">=</span> <span class="fu">var</span>(<span class="fu">f</span>(x) <span class="sc">-</span> <span class="fu">f_hat_2</span>(x))</span>
<span id="cb2-12"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-12" tabindex="-1"></a>var_3 <span class="ot">=</span> <span class="fu">var</span>(<span class="fu">f</span>(x) <span class="sc">-</span> <span class="fu">f_hat_3</span>(x))</span>
<span id="cb2-13"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-13" tabindex="-1"></a><span class="co"># calculate &#39;theoretical&#39; MSE</span></span>
<span id="cb2-14"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-14" tabindex="-1"></a>MSE_1 <span class="ot">=</span> bias_1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> var_1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2-15"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-15" tabindex="-1"></a>MSE_2 <span class="ot">=</span> bias_2<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> var_2 <span class="sc">+</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2-16"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-16" tabindex="-1"></a>MSE_3 <span class="ot">=</span> bias_3<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> var_3 <span class="sc">+</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2-17"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>){</span>
<span id="cb2-18"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-18" tabindex="-1"></a>  <span class="fu">cat</span> (<span class="fu">c</span>(<span class="st">&quot;==============================================&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb2-19"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-19" tabindex="-1"></a>  <span class="fu">cat</span> (<span class="fu">c</span>(<span class="st">&quot;=============== f_hat_1 ================&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb2-20"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-20" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;MSE_data1 = &quot;</span>, <span class="fu">round</span>(MSE_data1, <span class="dv">2</span>),  <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))</span>
<span id="cb2-21"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-21" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;bias_1 = &quot;</span>, bias_1, <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))   </span>
<span id="cb2-22"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-22" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;variance_1 = &quot;</span>, <span class="fu">round</span>(var_1, <span class="dv">2</span>), <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))  </span>
<span id="cb2-23"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-23" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;MSE_1 = 4 + bias_1^2 + variance_1 = &quot;</span>, MSE_1, <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> )) </span>
<span id="cb2-24"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-24" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;==============================================&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb2-25"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-25" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;=============== f_hat_2 ================&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb2-26"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-26" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;MSE_data2 = &quot;</span>, <span class="fu">round</span>(MSE_data2, <span class="dv">2</span>),  <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))</span>
<span id="cb2-27"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-27" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;bias_2 = &quot;</span>, bias_2, <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))   </span>
<span id="cb2-28"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-28" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;variance_2 = &quot;</span>, <span class="fu">round</span>(var_2, <span class="dv">2</span>), <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))  </span>
<span id="cb2-29"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-29" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;MSE_2 = 4 + bias_2^2 + variance_2 = &quot;</span>, MSE_2, <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))</span>
<span id="cb2-30"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-30" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;==============================================&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb2-31"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-31" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;=============== f_hat_3 ================&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb2-32"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-32" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;average y = &quot;</span>, <span class="fu">round</span>(y_bar, <span class="dv">2</span>),  <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))</span>
<span id="cb2-33"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-33" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;MSE_data3 = &quot;</span>, <span class="fu">round</span>(MSE_data3, <span class="dv">2</span>),  <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))</span>
<span id="cb2-34"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-34" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;bias_3 = &quot;</span>, <span class="fu">round</span>(bias_3, <span class="dv">2</span>), <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))   </span>
<span id="cb2-35"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-35" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;variance_3 = &quot;</span>, <span class="fu">round</span>(var_3, <span class="dv">2</span>), <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))  </span>
<span id="cb2-36"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-36" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;MSE_3 = 4 + bias_3^2 + variance_3 = &quot;</span>, <span class="fu">round</span>(MSE_3, <span class="dv">2</span>), <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))</span>
<span id="cb2-37"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-37" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;==============================================&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb2-38"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb2-38" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## ============================================== 
## =============== f_hat_1 ================ 
## MSE_data1 =  4.61 
## bias_1 =  1 
## variance_1 =  0 
## MSE_1 = 4 + bias_1^2 + variance_1 =  5 
## ============================================== 
## =============== f_hat_2 ================ 
## MSE_data2 =  7.64 
## bias_2 =  -2 
## variance_2 =  0 
## MSE_2 = 4 + bias_2^2 + variance_2 =  8 
## ============================================== 
## =============== f_hat_3 ================ 
## average y =  13 
## MSE_data3 =  36.7 
## bias_3 =  0 
## variance_3 =  33.84 
## MSE_3 = 4 + bias_3^2 + variance_3 =  37.84 
## ==============================================</code></pre>
<p><span class="math inline">\(\hat{f}_1\)</span> has a positive bias because it is overestimating data points more often than it is underestimating, but as it does it so consistently in comparison to <span class="math inline">\(f\)</span> that produces variance of zero. In contrast <span class="math inline">\(\hat{f}_2\)</span> has a negative bias as it is underestimating simulated data, but nonetheless it also does it consistently, resulting in zero variance with <span class="math inline">\(f\)</span>.</p>
<p>Unlike in the previous two model estimates which follow the data points, <span class="math inline">\(\hat{f}_3\)</span> predicts the mean value of data, resulting in no bias since it evenly underestimates and overestimates <span class="math inline">\(f(x)\)</span>. However, the variation in prediction between <span class="math inline">\(f\)</span> and <span class="math inline">\(\hat{f}_3\)</span> is obvious.</p>
<p>Given that the true function <span class="math inline">\(f\)</span> is linear, by applying simple regression modelling, we should be able to estimate it easily in R using the <span class="math inline">\(lm()\)</span> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-1" tabindex="-1"></a><span class="co"># model fitted to simulated data</span></span>
<span id="cb4-2"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-2" tabindex="-1"></a>f_hat_4<span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb4-3"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-3" tabindex="-1"></a>    <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb4-4"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-4" tabindex="-1"></a>}</span>
<span id="cb4-5"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-5" tabindex="-1"></a><span class="co"># plot the simulated data </span></span>
<span id="cb4-6"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-6" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">cex =</span> <span class="fl">0.75</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">main =</span> <span class="st">&quot;Simulation: 2&quot;</span>) </span>
<span id="cb4-7"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="at">col =</span><span class="st">&quot;gray&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb4-8"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-8" tabindex="-1"></a><span class="co"># add the line representing the fitted model</span></span>
<span id="cb4-9"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x), <span class="at">col =</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb4-10"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">7.5</span>, <span class="dv">8</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;f_hat_4&quot;</span>, <span class="st">&quot;f&quot;</span>),</span>
<span id="cb4-11"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-11" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;gray&quot;</span>), </span>
<span id="cb4-12"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-12" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb4-13"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb4-13" tabindex="-1"></a>       <span class="at">text.font =</span> <span class="dv">4</span>, <span class="at">bg =</span> <span class="st">&#39;lightyellow&#39;</span>)</span></code></pre></div>
<p><img src="01-S01-D1_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Since the true function <span class="math inline">\(f\)</span> is a linear model it is not surprising that <span class="math inline">\(\hat{f}_4\)</span> can learn it, resulting in zero values of the model’s bias and variance.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-1" tabindex="-1"></a><span class="co"># calculate MSE from data</span></span>
<span id="cb5-2"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-2" tabindex="-1"></a>MSE_data4 <span class="ot">=</span> <span class="fu">mean</span>((y <span class="sc">-</span> <span class="fu">predict</span>(<span class="fu">f_hat_4</span>(x)))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-3"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-3" tabindex="-1"></a><span class="co"># model bias </span></span>
<span id="cb5-4"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-4" tabindex="-1"></a>bias_4 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">predict</span>(<span class="fu">f_hat_4</span>(x)) <span class="sc">-</span> <span class="fu">f</span>(x))</span>
<span id="cb5-5"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-5" tabindex="-1"></a><span class="co"># model variance</span></span>
<span id="cb5-6"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-6" tabindex="-1"></a>var_4 <span class="ot">=</span> <span class="fu">var</span>(<span class="fu">f</span>(x) <span class="sc">-</span> <span class="fu">predict</span>(<span class="fu">f_hat_4</span>(x)))</span>
<span id="cb5-7"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-7" tabindex="-1"></a><span class="co"># calculate &#39;theoretical&#39; MSE</span></span>
<span id="cb5-8"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-8" tabindex="-1"></a>MSE_4 <span class="ot">=</span> bias_4<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> var_4 <span class="sc">+</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb5-9"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>){</span>
<span id="cb5-10"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-10" tabindex="-1"></a>  </span>
<span id="cb5-11"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-11" tabindex="-1"></a>  <span class="fu">cat</span> (<span class="fu">c</span>(<span class="st">&quot;==============================================&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb5-12"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-12" tabindex="-1"></a>  <span class="fu">cat</span> (<span class="fu">c</span>(<span class="st">&quot;=============== f_hat_4 ================&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb5-13"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-13" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;MSE_data4 = &quot;</span>, <span class="fu">round</span>(MSE_data4, <span class="dv">2</span>),  <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))</span>
<span id="cb5-14"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-14" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;bias_4 = &quot;</span>, <span class="fu">round</span>(bias_4, <span class="dv">2</span>), <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))   </span>
<span id="cb5-15"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-15" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;variance_4 = &quot;</span>, <span class="fu">round</span>(var_4, <span class="dv">2</span>), <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))  </span>
<span id="cb5-16"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-16" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;MSE_4 = 4 + bias_4^2 + variance_4 = &quot;</span>, <span class="fu">round</span>(MSE_4, <span class="dv">2</span>), <span class="at">sep =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span> ))</span>
<span id="cb5-17"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-17" tabindex="-1"></a>  <span class="fu">cat</span> (<span class="fu">c</span>(<span class="st">&quot;==============================================&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb5-18"><a href="demonstration-a-more-in-depth-consideration-of-model-accuracy.html#cb5-18" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## ============================================== 
## =============== f_hat_4 ================ 
## MSE_data4 =  3.62 
## bias_4 =  0 
## variance_4 =  0 
## MSE_4 = 4 + bias_4^2 + variance_4 =  4 
## ==============================================</code></pre>
<p><em>We realise that the <span class="math inline">\(MSE\)</span> is more than just a simple error measurement. It is a tool that informs and educates the modeller about the performance of the model being used in the analysis of a problem. It is packed with information that when unwrapped can provide a greater insight into not just the fitted model, but the nature of the problem and its data.</em></p>
<hr />
<p><span class="math inline">\(^*\)</span> <em>The Expectation of a Random Variable</em> is the sum of its values
weighted by their probability. For example: What is the average toss of
a fair six-sided die?</p>
<p>If the random variable is the top face of a tossed, fair six-sided die,
then the probability of die landing on <span class="math inline">\(X\)</span> is:</p>
<p><span class="math display">\[f(x) = \frac{1}{6}\]</span> for <span class="math inline">\(x = 1, 2,... 6\)</span>. Therefore, the average
toss, i.e. <strong>the expected value</strong> of <span class="math inline">\(X\)</span> is:</p>
<p><span class="math display">\[E(X) = 1(\frac{1}{6}) + 2(\frac{1}{6}) + 3(\frac{1}{6}) + 4(\frac{1}{6}) + 5(\frac{1}{6}) + 6(\frac{1}{6}) = 3.5\]</span>
Of course, we do not expect to get a fraction when tossing a die, i.e.
we do not expect the toss to be 3.5, but rather an integer number between 1 to 6. So, what the expected value is really saying is what is the expected average of a large number of tosses will be. If we toss a fair, six-side die hundreds of times and calculate the average of the tosses we will not get the exact 3.5 figure, but we will expect it to be close to 3.5. This is a <strong>theoretical average</strong>, not the exact one that is realised.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="overview.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
